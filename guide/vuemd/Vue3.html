<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>日拱一卒无有尽，功不唐捐终入海</title>
    <meta name="description" content="何元鹏">
    
    
    <link rel="preload" href="/assets/css/0.styles.54851b14.css" as="style"><link rel="preload" href="/assets/js/app.26183d58.js" as="script"><link rel="preload" href="/assets/js/2.e57cddc8.js" as="script"><link rel="preload" href="/assets/js/23.7d6916b7.js" as="script"><link rel="prefetch" href="/assets/js/10.10b4d136.js"><link rel="prefetch" href="/assets/js/11.8ba9850b.js"><link rel="prefetch" href="/assets/js/12.32ec6ad9.js"><link rel="prefetch" href="/assets/js/13.9c4c3b55.js"><link rel="prefetch" href="/assets/js/14.64ac4753.js"><link rel="prefetch" href="/assets/js/15.8b00143b.js"><link rel="prefetch" href="/assets/js/16.e1cc5a03.js"><link rel="prefetch" href="/assets/js/17.22f6c85c.js"><link rel="prefetch" href="/assets/js/18.8ff821f4.js"><link rel="prefetch" href="/assets/js/19.12aa189b.js"><link rel="prefetch" href="/assets/js/20.9f39d968.js"><link rel="prefetch" href="/assets/js/21.7ac61294.js"><link rel="prefetch" href="/assets/js/22.65157c2e.js"><link rel="prefetch" href="/assets/js/24.65db4685.js"><link rel="prefetch" href="/assets/js/25.555f89ec.js"><link rel="prefetch" href="/assets/js/26.af1bfc3b.js"><link rel="prefetch" href="/assets/js/27.d661cc97.js"><link rel="prefetch" href="/assets/js/28.b253968c.js"><link rel="prefetch" href="/assets/js/29.ed8fa68a.js"><link rel="prefetch" href="/assets/js/3.ce76472e.js"><link rel="prefetch" href="/assets/js/30.c2efa0a3.js"><link rel="prefetch" href="/assets/js/31.1d825ebf.js"><link rel="prefetch" href="/assets/js/32.2a68a03e.js"><link rel="prefetch" href="/assets/js/4.71ab0d48.js"><link rel="prefetch" href="/assets/js/5.045e847f.js"><link rel="prefetch" href="/assets/js/6.a6d59be0.js"><link rel="prefetch" href="/assets/js/7.d1387d37.js"><link rel="prefetch" href="/assets/js/8.ebe8911c.js"><link rel="prefetch" href="/assets/js/9.ced2f8d4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.54851b14.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">日拱一卒无有尽，功不唐捐终入海</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.jianshu.com/u/d90be3fdd9c5" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/InterfaceBoy" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.jianshu.com/u/d90be3fdd9c5" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/InterfaceBoy" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">首页</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>html基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>日常总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/vuemd/Vue3.html" class="active sidebar-link">Vue3学习笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#核心setup-props-context" class="sidebar-link">核心setup(props,context)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#props" class="sidebar-link">props</a></li><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#context" class="sidebar-link">context</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#响应式声明值ref、reactive" class="sidebar-link">响应式声明值ref、reactive</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#reactive" class="sidebar-link">reactive</a></li><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#ref" class="sidebar-link">ref</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#动态监听（computed，watch）" class="sidebar-link">动态监听（computed，watch）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#computed计算属性" class="sidebar-link">computed计算属性</a></li><li class="sidebar-sub-header"><a href="/guide/vuemd/Vue3.html#watch" class="sidebar-link">watch</a></li></ul></li></ul></li><li><a href="/guide/vuemd/VueSpot.html" class="sidebar-link">Vue框架应用知识点</a></li><li><a href="/guide/vuemd/Vue.html" class="sidebar-link">Vue框架</a></li><li><a href="/guide/vuemd/Vuex.html" class="sidebar-link">VueX状态管理模式</a></li><li><a href="/guide/vuemd/VueRouter.html" class="sidebar-link">Vue路由</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Ts语法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试准备</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>每日算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工作流</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实施监督系统</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="组合式api"><a href="#组合式api" class="header-anchor">#</a> 组合式api</h1> <p><strong>整理碎片化逻辑，将统一逻辑整理在一起，方便对逻辑进行处理</strong></p> <h2 id="核心setup-props-context"><a href="#核心setup-props-context" class="header-anchor">#</a> 核心setup(props,context)</h2> <h3 id="props"><a href="#props" class="header-anchor">#</a> props</h3> <p>在setup中的props参数是接收组件传入属性</p> <p>当props传入新的值时，setup中的值也会被更新，所以props是响应式的。<br> <strong>setup 执行时机是在 beforeCreate 之前执行</strong></p> <div class="language- extra-class"><pre class="language-text"><code>export default {
  props: {
    title: String
  },
  setup(props) {
    console.log(props.title)
  }
}
</code></pre></div><p>因为 props 是响应式的，你不能使用 ES6 解构，它会消除 prop 的响应性。</p> <p>需要解构 prop，可以在 setup 函数中使用 toRefs 函数来完成</p> <div class="language- extra-class"><pre class="language-text"><code>import { toRef } from 'vue'
setup(props) {
  const title = toRef(props, 'title')
  console.log(title.value)
}
</code></pre></div><h3 id="context"><a href="#context" class="header-anchor">#</a> context</h3> <p>在setup中的context参数是接收组件传入的方法<br>
context中就提供了三个属性：attrs、slot 和emit，分别对应 Vue2.x 中的 $attr属性、slot插槽 和$emit发射事件。并且这几个属性都是自动同步最新的值，所以我们每次使用拿到的都是最新值。</p> <div class="language- extra-class"><pre class="language-text"><code>export default {
  setup(props, context) {
    // Attribute (非响应式对象，等同于 $attrs)
    console.log(context.attrs)

    // 插槽 (非响应式对象，等同于 $slots)
    console.log(context.slots)

    // 触发事件 (方法，等同于 $emit)
    console.log(context.emit)

    // 暴露公共 property (函数)
    console.log(context.expose)
  }
}
</code></pre></div><p>this的使用</p> <blockquote><p>在 setup() 内部，this 不是该活跃实例的引用，因为 setup() 是在解析其它组件选项之前被调用的，所以 setup() 内部的 this 的行为与其它选项中的 this 完全不同。这使得 setup() 在和其它选项式 API 一起使用时可能会导致混淆。</p></blockquote> <h2 id="响应式声明值ref、reactive"><a href="#响应式声明值ref、reactive" class="header-anchor">#</a> 响应式声明值ref、reactive</h2> <p>两者之间的区别：在setup返回的refs在模版中访问时ref是自动浅解包，而reactive是深层解包。</p> <p>好处：可维护性明显提高，可以控制哪些变量暴露，可以跟中哪些属性被定义 （属性继承与引用透明）</p> <h3 id="reactive"><a href="#reactive" class="header-anchor">#</a> reactive</h3> <p>对引用数据类型数据进行装箱操作使得成为一个响应式对象，可以跟踪数据变化。</p> <div class="language- extra-class"><pre class="language-text"><code>const count = ref(1)
const obj = reactive({ count:count })

// ref 会被解包
console.log(obj.count === count.value) // true

// 它会更新 `obj.count`
count.value++
console.log(count.value) // 2
console.log(obj.count) // 2

// 它也会更新 `count` ref
obj.count++
console.log(obj.count) // 3
console.log(count.value) // 3
</code></pre></div><h4 id="isreactive"><a href="#isreactive" class="header-anchor">#</a> isReactive</h4> <p>检查对象是否是由 reactive 创建的响应式代理。</p> <h4 id="readonly"><a href="#readonly" class="header-anchor">#</a> readonly</h4> <p>接受一个对象 (响应式或纯对象) 或 ref 并返回原始对象的只读代理。只读代理是深层的：任何被访问的嵌套 property 也是只读的。</p> <div class="language- extra-class"><pre class="language-text"><code>const original = reactive({ count: 0 })

const copy = readonly(original)

watchEffect(() =&gt; {
  // 用于响应性追踪
  console.log(copy.count)
})

// 变更 original 会触发依赖于副本的侦听器
original.count++

// 变更副本将失败并导致警告
</code></pre></div><h4 id="shallowreactive"><a href="#shallowreactive" class="header-anchor">#</a> shallowReactive</h4> <p>创建一个响应式代理，它跟踪其自身 property 的响应性，但不执行嵌套对象的深层响应式转换 (暴露原始值)。</p> <div class="language- extra-class"><pre class="language-text"><code>const state = shallowReactive({
  foo: 1,
  nested: {
    bar: 2
  }
})

// 改变 state 本身的性质是响应式的
state.foo++
// ...但是不转换嵌套对象
isReactive(state.nested) // false
state.nested.bar++ // 非响应式
</code></pre></div><h3 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h3> <p>对基本数据类型数据进行装箱操作使得成为一个响应式对象，可以跟踪数据变化。<br>
接受一个内部值并返回一个响应式且可变的 ref 对象。ref 对象具有指向内部值的单个 property .value。</p> <h4 id="toref"><a href="#toref" class="header-anchor">#</a> toRef</h4> <p>主要用于接收props参数时使用，
因为即使源 property 不存在，toRef 也会返回一个可用的 ref。这使得它在使用可选 prop 时特别有用，可选 prop 并不会被 toRefs 处理。</p> <div class="language- extra-class"><pre class="language-text"><code>export default {
  setup(props) {
    useSomeFeature(toRef(props, 'foo'))
  }
}
</code></pre></div><h4 id="torefs"><a href="#torefs" class="header-anchor">#</a> toRefs</h4> <p>将响应式对象转化为普通对象，其中结果对象的每个 property 都是指向原始对象相应 property 的 ref。
主要用于reactive解构使用</p> <div class="language- extra-class"><pre class="language-text"><code>const state = reactive({
    foo: 1,
    bar: 2
  });

  const stateAsRefs = toRefs(state);

  // ref 和原始 property 已经“链接”起来了
  state.foo++;
  console.log(stateAsRefs.foo.value); // 2

  stateAsRefs.foo.value++;
  console.log(state.foo); // 3
  //  const { foo, bar } = stateAsRefs;
  const { foo, bar } = state;
  console.log(foo.value, bar.value);
</code></pre></div><h4 id="isref"><a href="#isref" class="header-anchor">#</a> isRef</h4> <p>检查值是否为一个 ref 对象。</p> <h2 id="动态监听（computed，watch）"><a href="#动态监听（computed，watch）" class="header-anchor">#</a> 动态监听（computed，watch）</h2> <h3 id="computed计算属性"><a href="#computed计算属性" class="header-anchor">#</a> computed计算属性</h3> <p>1、接受一个getter函数，并根据getter的返回值返回一个不可变的响应式ref对象。</p> <div class="language- extra-class"><pre class="language-text"><code>  const count = ref(1)
  const plusOne = computed(() =&gt; count.value + 1)

  console.log(plusOne.value) // 2

  plusOne.value++ // 错误 :返回的是一个不可变的响应式ref对象
</code></pre></div><p>2、或者，接受一个具有 get 和 set 函数的对象，用来创建可写的 ref 对象。</p> <div class="language- extra-class"><pre class="language-text"><code>  const count = ref(1);
  const plusOne = computed({
    get: () =&gt; count.value + 1,
    set: val =&gt; {
      count.value = val - 1;
    }
  });

  console.log(count.value); // 1 只是单纯的获取ref中count的值，未触发computed
  console.log(plusOne.value); // 2 获取computed属性值，触发get函数
  count.value = 2;
  console.log(plusOne.value); // 3 获取computed属性值，触发get函数，count.value=2,
  plusOne.value = 4;
  console.log(count.value); // 3 因为plusOne传入值，触发set函数，4-1=3。
  console.log(plusOne.value); // 4 当前count.value=3,获取计算属性触发get 3+1=4
</code></pre></div><p>3、在reactive中使用 computed</p> <div class="language- extra-class"><pre class="language-text"><code>const date = reactive({ 
  dates:new Date(),
  timeData:computed(()=&gt;{ 
    return date.dates
  }), 
  yearData:&quot;&quot;
})
const {timeData, yearData} = toRefs(date)

return {
  timeData, yearData
}
</code></pre></div><h3 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h3></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/InterfaceBoy/edit/master/docs/guide/vuemd/Vue3.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">何元鹏:</span> <span class="time">11/30/2021, 11:34:01 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/jsmd/Design.html" class="prev">设计模式笔记</a></span> <span class="next"><a href="/guide/vuemd/VueSpot.html">Vue框架应用知识点</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.26183d58.js" defer></script><script src="/assets/js/2.e57cddc8.js" defer></script><script src="/assets/js/23.7d6916b7.js" defer></script>
  </body>
</html>
